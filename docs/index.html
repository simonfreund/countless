<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simon Freund – countless, ongoing</title>
    <meta name="description"
        content="is an online installation by conceptual artist Simon Freund. The amount displayed is a reflection of the artist's financial situation at any given time.">
    <meta property="og:title" content="Simon Freund – countless, ongoing">
    <meta property="og:description"
        content="is an online installation by conceptual artist Simon Freund. The amount displayed is a reflection of the artist's financial situation at any given time.">
    <meta property="og:image" content="https://countless.info/countless.jpeg">
    <meta property="og:url" content="https://countless.info/">
    <meta property="og:type" content="website" />
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="centered">
        <a id="info" href="/info">
            <span id="saldo">...</span> EUR
        </a>
    </div>
    <script src="https://www.gstatic.com/firebasejs/7.9.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.9.2/firebase-firestore.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBlzzLBIbL8HRhSWFn0JccYPlBPi52pHz0",
            authDomain: "countless-5a92b.firebaseapp.com",
            databaseURL: "https://countless-5a92b.firebaseio.com",
            projectId: "countless-5a92b",
            storageBucket: "countless-5a92b.appspot.com",
            messagingSenderId: "144616170281",
            appId: "1:144616170281:web:b3fbb3b61a2b191cc94d38"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const allBalances = db.collection('balances')
        allBalances.get()
            .then(snapshot => {
                if (snapshot.empty) {
                    console.log('No matching documents.')
                    return false
                }
                const list = []
                snapshot.forEach(doc => {
                    list[doc.id] = doc.data().balance
                })
                const sum = list['comdirect'] + list['stripe'] - list['debt']
                return sum
            })
            .then(data => {
                if (data >= 0) {
                    document.getElementById("info").classList.add("positive");
                }
                const modifiedNumber = data.toFixed(2).replace('.', ',').replace(/\B(?=(\d{3})+(?!\d))/g, " ").replace(/\-/g, "– ")
                document.getElementById("saldo").innerHTML = modifiedNumber
            })
            .catch(err => {
                console.error('error', err);
                process.exit()
            })
    </script>
</body>

</html>
